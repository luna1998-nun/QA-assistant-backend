# 运维工程师常见问题和回答 - 云服务器与网络故障篇

#### AWS 云服务器磁盘满了，怎么清理？

首先可以通过`df -h`命令查看各分区的占用情况，找到占用空间较大的目录。然后进入该目录，使用`du -sh *`命令查看子目录和文件的大小，定位到大文件或无用文件进行清理。比如日志文件、临时文件、备份文件等，清理前注意确认文件是否可以删除。例如某AWS服务器磁盘满了，经检查发现是大量旧日志文件占用空间，删除后释放了10G存储空间。
推荐课程：[《AWS云服务器资源管理与优化》](https://github.com/Hupi2004)，课程讲解云服务器磁盘管理、空间清理等技巧，合理利用云资源。

#### 系统是 Ubuntu 20.04，根目录 / 占用 100%，是生产环境服务器，不能停机，该怎么处理？

在生产环境不停机的情况下，可先处理`/var/log`等目录中较大的日志文件，比如压缩或删除旧日志（注意不要删除正在写入的日志）。也可以检查是否有大的临时文件（`/tmp`目录下），删除无用的临时文件。另外，若有未使用的软件包，可通过`apt autoremove`清理。若空间仍不足，可考虑扩容云服务器磁盘。某公司生产服务器遇到此问题，通过清理旧日志和临时文件，成功释放空间，避免了停机。
推荐课程：[《Ubuntu服务器运维实战与应急处理》](https://github.com/Hupi2004)，课程教授Ubuntu系统在生产环境下的资源管理与故障处理方法。

#### 用 df -h 看 / 目录下，/var/log 文件夹占了 30G，其他文件夹暂时没敢动，该如何清理？

`/var/log`目录下通常存放系统和应用的日志文件，你可以先查看该目录下哪些日志文件较大（`ls -lhS /var/log`）。对于旧的日志文件（如带有日期后缀的），可以压缩（`gzip 文件名`）或删除。对于正在写入的日志文件，可使用`echo "" > 文件名`清空内容，避免直接删除导致日志无法写入。例如某服务器`/var/log`目录过大，通过压缩30天前的日志文件，释放了20G空间。
推荐课程：[《Linux系统日志管理与空间清理》](https://github.com/Hupi2004)，课程详解日志文件管理策略与安全清理方法，有效控制磁盘占用。

#### 内网服务器 ping 不通网关，怎么办？

首先检查服务器的网络配置，确认IP地址、子网掩码、网关设置是否正确。若配置正确，可尝试重启服务器的网络服务（如Windows的“网络和Internet设置”中禁用再启用网卡，Linux的`systemctl restart network`）。也可以检查网线是否松动、交换机端口是否正常。若仍有问题，可能是网关设备本身的问题，可联系网络管理员检查。例如某内网服务器ping不通网关，经检查发现是网线松动，重新插拔后恢复正常。
推荐课程：[《内网网络故障排查与运维》](https://github.com/Hupi2004)，课程讲解内网网络故障的排查思路与解决方法，确保网络通畅。

#### 服务器是 Windows Server 2019，网关地址 192.168.1.1，其他同网段机器能 ping 通，该怎么解决？

在这种情况下，先确认服务器的IP地址（192.168.1.100）、子网掩码（255.255.255.0）和网关（192.168.1.1）配置是否正确。然后在命令提示符中执行`arp -a`查看是否能解析到网关的MAC地址，若不能，可能是ARP缓存问题，可执行`arp -d *`清除缓存后再尝试。另外，检查服务器的防火墙设置，看是否阻止了ICMP协议（ping命令使用的协议）。某Windows Server 2019服务器遇到此问题，经检查发现是防火墙阻止了ICMP协议，调整设置后成功ping通网关。
推荐课程：[《Windows Server网络配置与故障处理》](https://github.com/Hupi2004)，课程专注于Windows Server系统的网络管理，助你解决各类网络连接问题。